<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Game</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<h1>Memory Game</h1>

<!-- Game Settings -->
<div id="game-settings">
    <label for="image-type">Afbeeldingstype:</label>
    <select id="image-type">
        <option value="cat">Katten</option>
        <option value="picsum">Random Afbeeldingen</option>
        <option value="dog">Honden</option>
    </select>

    <label for="board-size">Bordgrootte:</label>
    <select id="board-size">
        <option value="4x4">4x4</option>
        <option value="6x6" selected>6x6</option>
        <option value="8x8">8x8</option>
    </select>

    <label for="card-back-symbol">Symbool achterkant:</label>
    <select id="card-back-symbol">
        <option value="@">@</option>
        <option value="#">#</option>
        <option value="$">$</option>
        <option value="&">&</option>
    </select>

    <label for="closed-card-color">Kleur gesloten kaarten:</label>
    <input type="color" id="closed-card-color" value="#999">

    <label for="open-card-color">Kleur open kaarten:</label>
    <input type="color" id="open-card-color" value="#ADD8E6">

    <label for="found-card-color">Kleur gevonden kaarten:</label>
    <input type="color" id="found-card-color" value="#90EE90">

    <button id="start-game">Start Spel</button>
</div>

<!-- Timer -->
<div id="timer-container">
    <p>Verstreken tijd: <span id="elapsed-time">0s</span></p>
    <p>Resterende tijd: <span id="remaining-time">60s</span></p>
</div>

<!-- Top 5 Scores -->
<div id="top-scores">
    <h2>Top 5 Scores</h2>
    <ul id="score-list"></ul>
</div>

<!-- Game Board -->
<div id="game-board"></div>

<p id="result"></p>

<!-- Scripts -->
<script type="module" src="js/main.js"></script>
<script>
    const checkConnection = () => {
        fetch('http://localhost:8000/frontend')
            .then(resp => resp.json())
            .then(json => {
                console.log(json);
                let datum = new Date(json['date']).toLocaleDateString('NL-nl', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                document.getElementById('result').innerHTML = json['message'];
                document.getElementById('result').innerHTML += `<br/>De huidige datum is ${datum}`;
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('result').innerHTML = 'Er is een fout opgetreden bij het verbinden met de backend.';
            });
    };

    const fetchTopScores = () => {
        const token = localStorage.getItem('jwt');
        if (!token) {
            alert('Je bent niet ingelogd. Je wordt doorgestuurd naar de loginpagina.');
            window.location.href = 'login.html';
            return;
        }

        fetch('http://localhost:8000/scores', {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        })
            .then(response => response.json())
            .then(scores => {
                const scoreList = document.getElementById('score-list');
                scoreList.innerHTML = ''; // Clear existing scores
                scores.slice(0, 5).forEach(score => {
                    const li = document.createElement('li');
                    li.textContent = `${score.username}: ${score.score}`;
                    scoreList.appendChild(li);
                });
            })
            .catch(error => {
                console.error('Error fetching top scores:', error);
                document.getElementById('score-list').innerHTML = '<li>Kan scores niet laden.</li>';
            });
    };

    document.getElementById('start-game').addEventListener('click', () => {
        checkConnection();
        fetchTopScores();
    });

    // Initial checks
    checkConnection();
    fetchTopScores();
</script>
<script src="js/fetchOverride.js"></script>
</body>
</html>
